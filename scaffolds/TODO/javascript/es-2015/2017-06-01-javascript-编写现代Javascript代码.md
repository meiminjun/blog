title: javascriptæ·±å…¥æµ…å‡ºç³»åˆ—-es6-ç¼–å†™ç°ä»£Javascriptä»£ç 
date: 2017-06-01 09:50:13
tags:
  - javascript
  - es-2015
  - linter
---

åŸæ–‡ï¼š https://dev.to/scastiel/writing-modern-javascript-code

# ç¼–å†™ç°ä»£Javascriptä»£ç 

è®°å¾—ä»¥å‰Javascriptè¿˜å¤„äºæ˜¯ä¸€ç§æ”¹å˜é¡µé¢å…ƒç´ çš„è¯­è¨€ï¼Ÿè¿™äº›æ—¥å­å·²ç»è¿‡å»äº†ï¼Œæ¯ç§è¯­è¨€éšç€æ—¶é—´çš„æ¨ç§»è€Œå‘å±•ï¼Œæˆ‘ä»¬ä½¿ç”¨å®ƒä»¬ä¹Ÿæ˜¯å¦‚æ­¤ï¼Œçœ‹çœ‹ä½ ä¸€ä¸¤å¹´å‰å†™çš„ä»£ç ï¼šä½ ä¸æ„Ÿåˆ°ç¾æ„§å—ï¼Ÿå¦‚æœæ˜¯ï¼Œè¿™ç¯‡å¸–å­å°±æ˜¯å†™ç»™ä½ çš„
ğŸ™‚

åœ¨è¿™ç¯‡æ–‡ç« é‡Œï¼Œæˆ‘ä¼šå°è¯•è¿™é‡Œåˆ—å‡ºä¸€äº›å¾ˆå¥½çš„åšæ³•ï¼Œä½¿æ‚¨çš„JavaScriptä»£ç æ›´å®¹æ˜“ç¼–å†™ï¼Œé˜…è¯»å’Œç»´æŠ¤

# ä½¿ç”¨å¯ä»¥æ ¼å¼åŒ–ä»£ç çš„linter

ç¬¬ä¸€ä¸ªå»ºè®®æ˜¯ä½¿ç”¨ä¸€ä¸ªä»£ç linter,ä»–ä¼šæ£€æŸ¥ä½ çš„æ¯ä¸€è¡Œä»£ç æ˜¯å¦éµå®ˆç»Ÿä¸€è§„åˆ™ï¼Œç‰¹åˆ«æ˜¯å‡ ä¸ªå¼€å‘äººå‘˜ååŒå¼€å‘ä¸€ä¸ªé¡¹ç›®çš„æ—¶å€™ï¼šç¼©å‡ï¼Œæ‹¬å·ä¸­çš„ç©ºæ ¼ï¼Œå°†==æ›¿æ¢ä¸º===...

ä½†æ›´é‡è¦çš„æ˜¯ï¼Œå°½å¯èƒ½è®©æ‚¨çš„linterè‡ªåŠ¨ä¿®å¤æ‚¨çš„ä»£ç ã€‚ ESLintéå¸¸å¥½ï¼ˆä½¿ç”¨--fixé€‰é¡¹ï¼‰ï¼Œå®ƒä¸æ‰€æœ‰ä¸»è¦çš„IDEé›†æˆï¼Œå¯ä»¥åœ¨ä¿å­˜æ—¶è‡ªåŠ¨ä¿®å¤æ–‡ä»¶ã€‚

æ‚¨ä¹Ÿå¯ä»¥ä½¿ç”¨æ›´ä¸ºä¸“æ³¨äºæ ¼å¼åŒ–çš„â€œæ¼‚äº®â€ï¼Œè€Œä¸æ˜¯æ£€æŸ¥ï¼Œä½†ç»“æœåŸºæœ¬ç›¸åŒğŸ˜‰

ä¸‹ä¸€ç‚¹å°†å¸®åŠ©ä½ é€‰æ‹©ä½ çš„linterä½¿ç”¨çš„è§„åˆ™:

# ä¸ºä½ çš„linterä½¿ç”¨ç°ä»£è§„åˆ™

å¦‚æœæ‚¨æƒ³çŸ¥é“æ‚¨çš„ä»£ç éœ€è¦ä»€ä¹ˆè§„åˆ™ï¼Œè¿™é‡Œæœ‰ä¸€ä¸ªæç¤º:StandardJS. 
è¿™æ˜¯ä¸€ä¸ªéå¸¸ä¸¥æ ¼çš„linter,ä¸ä¼šåœ¨è§„åˆ™ä¸­ç»™æ‚¨ä»»ä½•é€‰æ‹©ï¼Œä½†æ˜¯å®ƒä»¬ä¸­çš„æ¯ä¸€ä¸ªéƒ½è¶Šæ¥è¶Šè¢«ç¤¾åŒºæ‰€æ‰¿è®¤ã€‚ä¸‹é¢æ˜¯ä¸€äº›ä¾‹å­:

* ä½¿ç”¨2ç©ºæ ¼ç¼©è¿›(æˆ‘æ›¾ç»ä½¿ç”¨4ä¸ªç©ºæ ¼,ä½†å®é™…ä¸Šä½¿ç”¨2æ˜¯ç›¸å½“ä¸é”™)
* æ²¡æœ‰åˆ†å·
* åœ¨å…³é”®å­—(å¦‚if)å’ŒèŠ±æ‹¬å·ååŠ ç©ºæ ¼
* and [a lot more](https://standardjs.com/rules-zhcn.html).

# ä½¿ç”¨ES2015 +æ–°ç‰¹æ€§

å¦‚æœä½ ç”¨JavaScriptå¼€å‘,ä½ è¿˜æ²¡æœ‰å¬è¯´è¿‡ES2015 +(æˆ–ES6 ES7â€¦)ç‰¹æ€§ã€‚è¿™æ˜¯ä¸å¯æˆ–ç¼ºçš„äº†:

* ç®­å¤´å‡½æ•°ï¼šç¼–å†™å‡½æ•°å¯ä»¥åƒ x => x * 2 æ˜¯éå¸¸æœ‰ç”¨çš„å‡½æ•°å¼ç¼–ç¨‹
* ç±»ï¼šåœæ­¢ä½¿ç”¨åŸå‹å‡½æ•°ï¼Œç±»æ›´é…·ï¼ˆä½†æ˜¯ä¸è¦æ»¥ç”¨,JavaScriptæ¯”ä»»ä½•é¢å‘å¯¹è±¡çš„è¯­è¨€éƒ½è¦å¥½å¾—å¤šï¼‰
* ä½¿ç”¨æ•°ç»„å’Œå¯¹è±¡è¿›è¡Œæ“ä½œ

```
function doSomething() {
  const a = doSomethingElse()
  const b = doSomethingWithA(a)
  const otherResults = { c: 'ğŸ˜º', d: 'ğŸ¶' }
  return { a, b, ...otherResults } // ç›¸å½“äº { a: a, b: bï¼Œc: 'ğŸ˜º', d: 'ğŸ¶' }
}
const { a, c, ...rest } = doSomething() // åŒæ ·é€‚ç”¨äºæ•°ç»„
// `rest` ç›¸å½“äº { b: ..., d: 'ğŸ¶' }
```

* ä½¿ç”¨æ›´å®¹æ˜“çš„ä½¿ç”¨çš„async/await:

```
async function doSomething() {
  const a = await getValueForA()
  const b = await getValueForBFromA(a)
  const [c, d] = await Promise.all([
    // parallel execution
    getValueForC(), getValueForDFromB(b)
  ])
  const total = await calculateTotal(a, b, c, d)
  return total / 1000
}
```

æˆ‘ä»¬æ€æ ·ä½¿ç”¨è¿™äº›ç‰¹æ€§å‘¢ï¼Ÿæˆ‘çš„ä¸€ç¯‡æ–‡ç« ç»™ä½ ä¸€äº›å»ºè®®ï¼ˆé¡ºä¾¿è¯´ä¸€ä¸‹,ä¸æœ€æ–°ç‰ˆæœ¬çš„Node.js,ä½ å¯èƒ½ä¸éœ€è¦babelå°±å¯ä»¥ä½¿ç”¨æœ€æ–°çš„ä¸€äº›ç‰¹æ€§ï¼‰

# ä½¿ç”¨å‡½æ•°å¼ç¼–ç¨‹

ç°åœ¨ï¼Œå‡½æ•°å¼ç¼–ç¨‹å·²ç»å–å¾—äº†å¾ˆå¤§çš„æˆåŠŸï¼Œä¸ä»…ä»…æ˜¯åœ¨JavaScriptä¸­ã€‚è¿™æ˜¯ä»€ä¹ˆåŸå› å‘¢?å®ƒä½¿ä»£ç æ›´åŠ å¯é¢„æµ‹ã€æ›´å®‰å…¨ã€æ›´ç¡®å®šï¼Œå¹¶ä¸”åœ¨ä½¿ç”¨æ—¶æ›´å®¹æ˜“ç»´æŠ¤ã€‚ä»¥ä¸‹æ˜¯ä¸€äº›ç®€å•çš„å»ºè®®:

é¦–å…ˆï¼Œåœæ­¢ä½¿ç”¨forå¾ªç¯ï¼Œåœ¨å¤§å¤šæ•°æƒ…å†µä¸‹ä½ ä¸éœ€è¦ä»–ä»¬ï¼Œä¾‹å¦‚ï¼š

```
const arr = [{ name: 'first', value: 13 }, { name: 'second', value: 7 }]

// ä»¥å‰:
const res = {}
for (let i = 0; i < arr.length; i++) {
  const calculatedValue = arr[i].value * 10
  if (calculatedValue > 100) {
    res[arr[i].name] = calculatedValue
  }
}

// æ›´å¥½:
const res = arr
  .map(elem => ({ name: elem.name, calculatedValue: elem.value * 10 }))
  .filter(elem => elem.calculatedValue > 100)
  .reduce((acc, elem) => ({
    [elem.name]: calculatedValue,
    ...acc
  }), {})
```

reduce()è¿­ä»£è¿‡ç¨‹  | previousValue |currentValue |index |array | return value
---             | ---            | ---         | ---  | ---  | ---
ç¬¬1æ¬¡è°ƒç”¨        | 1               | 2           | 1    | [1,2, undefined, 4,5,6]| 12
ç¬¬2æ¬¡è°ƒç”¨        | 12               | 4          |3           | [1,2, undefined, 4,5,6]| 124
ç¬¬3æ¬¡è°ƒç”¨        | 124              | 5          | 4          | [1,2, undefined, 4,5,6]| 1245
ç¬¬4æ¬¡è°ƒç”¨        | 1245               | 6           | 5           | [1,2, undefined, 4,5,6]| 12456

